var App=App||{};!function(){App.Cadastro={init:function(){this.Login(),this.Formulario()},Login:function(){$("#login_form").submit(function(){$("#loading").show();var e=$("#login_identificador").val(),o=$("#senha_identificador").val(),t="identificador="+e+"&senha="+o+"&hash=",a=new XMLHttpRequest;a.withCredentials=!0,a.addEventListener("readystatechange",function(){if($("#loading").hide(),4===this.readyState){if(this.responseText){var o=JSON.parse(this.responseText);console.log(o),o.mensagens&&$.cookie("response",o.mensagens[0].detalhe),$.cookie("client_id",e),$.cookie("token",o.token),$.cookie("user_name",o.nome),$.cookie("user_perfis",o.perfis),$.cookie("idUsuarioOrganizacaoAtual",o.idUsuarioOrganizacaoAtual),$.cookie("tipoDeOrganizacao",o.tipoDeOrganizacao)}App.Cadastro.Formulario()}}),a.open("POST","https://dev.appcordovajade.com.br/ws/login"),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(t)})},Formulario:function(){void 0!=$.cookie("token")?($(".set-back").show(),$(".set-back").attr("href","#login"),$(".set-back").click(function(){"#login"==$(this).attr("href")?($("#formulario").hide(),$("#login").show(),$(".set-back").hide(),$.removeCookie("token"),$("#login_identificador").val(""),$("#senha_identificador").val(""),$("a.navbar-brand").text("Cadastro")):"#cadastro"==$(this).attr("href")&&($("section").hide(),$($(this).attr("href")).show(),$("a.navbar-brand").text("Cadastro")),"#veiculo"==$(this).attr("href")&&($("section").hide(),$($(this).attr("href")).show(),$("#add_veiculo").hasClass("edit")?$("a.navbar-brand").text("Editar Veículo"):$("a.navbar-brand").text("Novo Veículo"))}),App.Cadastro.Salvar(),App.Cadastro.Documentos(),$("#cadastro").find("#login").hide(),$("#cadastro").find("#formulario").show(),$("#uf_appcordovajade").change(function(){App.Cadastro.Cidades($(this).val())}),$("#add_veiculo").click(function(){$("section").hide(),$("#cadastro_veiculo").show(),App.Veiculo.Novo()})):void 0!=$.cookie("response")&&($("#alert-modal").find(".modal-body strong").text($.cookie("response")),$("#alert-modal").modal())},Cidades:function(e){var o=new XMLHttpRequest;o.withCredentials=!0,o.addEventListener("readystatechange",function(){if(4===this.readyState){var e=this.responseText,o=JSON.parse(e);$("#cidades_appcordovajade").html('<option value="">Escolher</option>');for(var t=0;t<o.length;t++)$("#cidades_appcordovajade").append('<option value="'+o[t].id+'">'+o[t].nome+"</option>")}else 0===this.readyState&&($("#alert-modal").find(".modal-body strong").text("Cidades: Erro de comunicação com o Servidor!"),$("#alert-modal").modal())}),o.open("GET","https://dev.appcordovajade.com.br/ws/cidades/"+e),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("Client-Id",$.cookie("client_id")),o.setRequestHeader("Authorization",$.cookie("token")),o.send(null)},Documentos:function(){var e=new XMLHttpRequest;e.withCredentials=!0,e.addEventListener("readystatechange",function(){if(4===this.readyState){var e=this.responseText,o=JSON.parse(e);$("#tipo_financiamento").html('<option value="">Escolher</option>');for(var t=0;t<o.length;t++)$("#tipo_financiamento").append('<option value="'+o[t].codigo+'">'+o[t].nome+"</option>")}else 0===this.readyState&&($("#alert-modal").find(".modal-body strong").text("Documentos: Erro de comunicação com o Servidor!"),$("#alert-modal").modal())}),e.open("GET","https://dev.appcordovajade.com.br/ws/tiposDocumento"),e.setRequestHeader("Client-Id",$.cookie("client_id")),e.setRequestHeader("Authorization",$.cookie("token")),e.send(null)},isJson:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},Salvar:function(){$("#concluir_cadastro").click(function(){$("#loading").show();var e=JSON.stringify({devedor:{tipo:$("#tipo_devedor").val(),cpfCnpj:$("#cpf_devedor").val(),nome:$("#nome_devedor").val(),ddd:$("#telefone_ddd").val(),numero:$("telefone_devedor").val()},enderecoDevedor:{cep:$("#cep_devedor").val(),logradouro:$("#logradouro_devedor").val(),numero:$("#numero_devedor").val(),bairro:$("#bairro_devedor").val(),complemento:$("#complemento_devedor").val(),uf:$("#uf_appcordovajade").val(),cidade:$("#cidades_appcordovajade").val()},veiculos:[{marca:$.cookie("marca_text"),modelo:$.cookie("modelo_name"),chassi:$.cookie("chassi_veiculo")}],tipoDocumento:{codigo:$("#tipo_financiamento").val()}}),o=new XMLHttpRequest;o.withCredentials=!0,o.addEventListener("readystatechange",function(){var e=this;setTimeout(function(){if($("#loading").hide(),4===e.readyState)if(App.Cadastro.isJson(e.responseText)){var o=JSON.parse(e.responseText);$("#alert-modal").find(".modal-body strong").text(o.mensagens[0].valor),$("#alert-modal").modal()}else $("#alert-modal").find(".modal-body strong").text("Token expirado, tente novamente!"),$("#alert-modal").modal(),$(".set-back").click();else 0===e.readyState&&($("#alert-modal").find(".modal-body strong").text("Cadastro: Erro de comunicação com o Servidor!"),$("#alert-modal").modal(),$(".set-back").click())},1e3)}),o.open("POST","https://dev.appcordovajade.com.br/ws/servicos/protocolarRegistro"),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Client-Id",$.cookie("client_id")),o.setRequestHeader("Authorization",$.cookie("token")),o.send(e)})}}}();var App=App||{};!function(){App.Consulta={init:function(){this.Forms()},Forms:function(){$(".menu-consulta").find("a").click(function(){$(".menu-consulta .button-all").removeClass("active"),$(this).parent().addClass("active");var e=$(this).attr("href");$(".forms-consulta > div").hide(),$(".forms-consulta > "+e).show()}),$(".form_consulta").submit(function(){$("#loading").show();var e=$(this);setTimeout(function(){App.Consulta.GET(e)},1e3)})},GET:function(e){var o=new XMLHttpRequest;o.withCredentials=!0,o.addEventListener("readystatechange",function(){if($("#loading").hide(),4===this.readyState){console.log(this.responseText);var e=JSON.parse(this.responseText);void 0!=e.nivelMensagem?($("#alert-modal").find(".modal-body strong").text(e.nivelMensagem+": "+e.texto),$("#alert-modal").modal()):($("#alert-modal").find(".modal-body strong").text("Preencha todos os campos corretamente!"),$("#alert-modal").modal())}});var t=e.find(".consulta_chassi").val();void 0==t&&(t="");var a=e.find(".consulta_cpf").val();void 0==a&&(a="");var n=e.find(".consulta_credora").val();void 0==n&&(n=""),o.open("GET","https://dev.appcordovajade.com.br/ws/consultaPublica?chassi="+t+"&cnpjCredor="+n+"&cpfCnpjDevedor="+a),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(null)}}}();var App=App||{};!function(){App.Footer={init:function(){this.Groups()},Groups:function(){$("#footer-appcordovajade").find("a").click(function(){$("#footer-appcordovajade").find(".button-footer").removeClass("active"),$(this).parent().addClass("active");var e=$(this).data("group");$(".main-group > ").hide(),$(".main-group > "+e).show(),"#qr"==e?App.Qr.init():"#cadastro"==e?App.Cadastro.init():App.Qr.unit();var o=$(this).data("brand");$("a.navbar-brand").text(o)})}}}();var App=App||{};!function(){App.Main={init:function(){this.cacheSelectors(),this.bindScripts()},cacheSelectors:function(){this.dataScript=document.querySelectorAll("[data-script]")},bindScripts:function(){for(var e=Array.prototype.slice.call(this.dataScript),o=e.map(function(e){return e.getAttribute("data-script")}),t=o.filter(function(e,t){return o.indexOf(e)==t}),a=0;a<t.length;a++)App[t[a]].init()}},document.addEventListener("DOMContentLoaded",function(){App.Main.init()})}();var App=App||{};!function(){App.Qr={unit:function(){QRScanner.destroy(function(e){console.log(e)})},init:function(){function e(e,o){function t(e,o){if(e);else{$("#loading").show();var t=new XMLHttpRequest;t.withCredentials=!0,t.addEventListener("readystatechange",function(){var e=this;if(4===e.readyState){var o=JSON.parse(e.responseText);o.texto?($("#alert-modal").find(".modal-body strong").text(o.nivelMensagem+": "+o.texto),$("#alert-modal").modal()):($("#alert-modal").find(".modal-body strong").text("Certidão não encontrada."),$("#alert-modal").modal()),App.Qr.unit(),setTimeout(function(){App.Qr.init()},1e3)}$("#loading").hide()}),t.open("GET","https://dev.appcordovajade.com.br/ws/consultaPublica/certidao/"+o),t.setRequestHeader("Client-Id","86634720134"),t.setRequestHeader("Authorization","eyJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiZGlyIn0..Q6-Fgr_XwAKhE668.3aFqk3FSOHHJEmEVWL9r6LOnTzbvEwK91ZjZOY4rbVxgs4IRGIOGsTglpd5I-tJU6NKUuyEbdGQCtpSKxyrTBWasHy0JgdUuZaNsIATAfGB5MOUgot6-a0jMaSLJdIeMxZUduxnXK19tPRxmjjHs09k9ajP6xLI_lYZkT8FlXKyRC08WBuQWZp2rSR-_poCBaKfjyByJrcq8n56KBLU-0oLIRyiQ6VKQrHoNUxRFPMOTcCZPd-bDQyYoNFR2s5YOk_A_.sK0pW0oJ3annidlUfymTIg"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(null)}}e&&console.error(e),o.authorized?(QRScanner.scan(t),QRscanner.show()):o.denied&&QRScanner.openSettings()}this.unit(),QRScanner.prepare(e)}}}();var App=App||{};!function(){App.Veiculo={Novo:function(){$(".set-back").attr("href","#cadastro"),$("#add_veiculo").hasClass("edit")?$("a.navbar-brand").text("Editar Veículo"):($("a.navbar-brand").text("Novo Veículo"),$.removeCookie("chassi_veiculo"),$.removeCookie("modelo_name"),$.removeCookie("modelo_value"),$.removeCookie("marca_text"),$.removeCookie("marca_selecionada")),App.Veiculo.Marca(),$("#veiculo_modelo").click(function(){App.Veiculo.Modelo($("#marcas_appcordovajade").val())}),$("#veiculo_chassi").val($.cookie("chassi_veiculo")),$("#veiculo_modelo").text($.cookie("modelo_name")),$("#add_veiculo_form").click(function(){$(".set-back").attr("href","#login"),$.cookie("chassi_veiculo",$("#veiculo_chassi").val()),$("section").hide(),$("#cadastro").show(),$("#add_veiculo").addClass("edit"),$("#add_veiculo").text($.cookie("marca_text")+" - "+$.cookie("modelo_name")),location.hash="#cidades_appcordovajade"})},Marca:function(){var e=new XMLHttpRequest;e.withCredentials=!0,e.addEventListener("readystatechange",function(){if(4===this.readyState){var e=this.responseText,o=JSON.parse(e);$("#marcas_appcordovajade").html('<option value="">Escolher</option>');for(var t=0;t<o.length;t++)$("#marcas_appcordovajade").append('<option value="'+o[t].id+'">'+o[t].descricao+"</option>");$("#marcas_appcordovajade").val($.cookie("marca_selecionada")),$("#marcas_appcordovajade").change(function(){$.cookie("marca_selecionada",$(this).val()),$.cookie("marca_text",$("#marcas_appcordovajade option:selected").text()),$("#veiculo_modelo").text("Escolha um Modelo")})}}),e.open("GET","https://dev.appcordovajade.com.br/ws/fabricantes"),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.setRequestHeader("Client-Id",$.cookie("client_id")),e.setRequestHeader("Authorization",$.cookie("token")),e.send(null)},Modelo:function(e){if(e){$(".set-back").attr("href","#veiculo"),$("a.navbar-brand").text("Modelo"),$("section").hide(),$("#cadastro_modelo").show();var o=new XMLHttpRequest;o.withCredentials=!0,o.addEventListener("readystatechange",function(){if(4===this.readyState){var e=this.responseText,o=JSON.parse(e);$("#modelos_appcordovajade").html("");for(var t=0;t<o.length;t++)$("#modelos_appcordovajade").append('<button class="add" style="margin: 0;" data-value="'+o[t].id+'">'+o[t].descricao+"</button>");location.hash="#main",$("#modelos_appcordovajade").find("button").click(function(){$(".set-back").attr("href","#cadastro"),$.cookie("modelo_value",$(this).data("value")),$.cookie("modelo_name",$(this).text()),$("section").hide(),$("#cadastro_veiculo").show(),$("#veiculo_modelo").text($.cookie("modelo_name"))})}}),o.open("GET","https://dev.appcordovajade.com.br/ws/veiculos/"+e),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.setRequestHeader("Client-Id",$.cookie("client_id")),o.setRequestHeader("Authorization",$.cookie("token")),o.send(null)}else $("#alert-modal").find(".modal-body strong").text("Seleciona uma Marca/Frabricante"),$("#alert-modal").modal()}}}();